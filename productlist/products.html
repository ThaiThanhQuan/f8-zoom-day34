<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <div id="root"></div>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script type="text/babel">

        function Product() {
            
            const[posts, setPosts] = React.useState([])
            const[loading, setLoading] = React.useState(true)
            const [selectedPost, setSelectedPost] = React.useState({});

            React.useEffect(() => {
                fetch('https://jsonplaceholder.typicode.com/posts?_limit=12')
                .then(reps => reps.json())
                .then(data => {
                    setPosts(data)
                    setLoading(false)
                })
            },[])

             const upper = ((title)=> {
                return title.charAt(0).toUpperCase() + title.slice(1)
            })

            const cutText = ((text) => {
                if(text.length > 100){
                    return text.substring(0,100) + '...'
                }
            })
            const showModal = ((id) => {
                const modal = document.querySelector('.modal')
                const post = posts.find(post => post.id === id);
                 if (post) {
                     modal.classList.add('open');
                     setSelectedPost(post)
                }
                
            })
            const hideModal = (() => {
                const modal = document.querySelector('.modal')
                modal.classList.remove('open');
                setSelectedPost({})
            })

            return(
               <>
                   <div>
                        <h1 className="header">PRODUCT LIST</h1>
                       { loading ? <p className='loading'>Đang tải</p> : (
                            posts.map(post => (
                                <ul key={post.id} className="content">
                                    <div className="content-header">
                                    <    li className="content-id">{post.id}</li>
                                        <li className="content-title">{upper(post.title)}</li>
                                    </div>
                                   <div className="content-footer">
                                        <li className="content-body">{cutText(post.body)}</li>
                                        <button className="btn" onClick = {() => showModal(post.id)}>Xem chi tiết</button>
                                   </div>
                                </ul>
                            )))}
                    </div>

                    <div className="modal">
                        <div className="modal-container ">
                            <header className="modal-header">
                                POST INFORMATION
                                <i className="modal-close fa-regular fa-circle-xmark" onClick = {() => hideModal()}></i>
                            </header>
                            

                            <div className="modal-body">
                                {selectedPost && (
                                    <ul className="content-modal">
                                        <div className="content-modal-header">
                                        <li className="content-modal-id">{selectedPost.id}</li>
                                        <li className="content-modal-title">{selectedPost.title}</li>
                                        </div>
                                        <div className="content-modal-footer">
                                            <li className="content-modal-body">{selectedPost.body}</li>
                                        </div>
                                    </ul>
                                )}
                            </div>

                            <footer className="modal-footer">
                                <button className="modal-btn" onClick = {() => hideModal()}>Close</button>
                            </footer>
                        </div>
                    </div>
               </>
                
            )
        }

        const app = (
                <Product />
        )

        const root = ReactDOM.createRoot(document.querySelector('#root'))
        root.render(app)            
    </script>
</body>

</html>